{"remainingRequest":"/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/babel-loader/lib/index.js!/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/src/views/company/ComList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/src/views/company/ComList.vue","mtime":1578713142249},{"path":"/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/cache-loader/dist/cjs.js","mtime":1571637271763},{"path":"/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/cache-loader/dist/cjs.js","mtime":1571637271763},{"path":"/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/Users/cyb/work/KaiFa/cz_workSpace/robotWeb/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { queryData } from '@/api/common';\nimport DetailList from '@/components/tools/DetailList';\nvar DetailListItem = DetailList.Item;\nexport default {\n  components: {\n    DetailList: DetailList,\n    DetailListItem: DetailListItem\n  },\n  data: function data() {\n    return {\n      form: this.$form.createForm(this),\n      expandedKeys: [],\n      searchValue: '',\n      autoExpandParent: true,\n      orgTree: [],\n      orgList: [],\n      comInfo: [],\n      pid: '',\n      isSelect: false,\n      addVisible: false,\n      editVisible: false,\n      addForm: {\n        name: '',\n        contact: '',\n        contactWay: '',\n        descn: ''\n      },\n      editForm: {},\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 7\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 13\n        }\n      }\n    };\n  },\n  beforeMount: function beforeMount() {\n    this.getDateTree();\n  },\n  methods: {\n    // 新增\n    handleAdd: function handleAdd() {\n      var _this2 = this;\n\n      var validateFields = this.form.validateFields;\n\n      var _this = this;\n\n      validateFields(function (errors, values) {\n        if (!errors) {\n          console.log('values', values);\n        }\n\n        var param = _objectSpread({\n          pid: _this2.pid\n        }, values.addForm);\n\n        console.log(param);\n        queryData(param, '/hrOrg/save').then(function (res) {\n          if (res.code == 0) {\n            _this.$message.success('新建成功');\n\n            _this.addVisible = false;\n\n            _this.form.resetFields();\n\n            _this.getDateTree();\n          } else {\n            _this.$message.error(res.message);\n          }\n        });\n      });\n    },\n    // 编辑\n    handleEdit: function handleEdit() {\n      var _this3 = this;\n\n      var validateFields = this.form.validateFields;\n\n      var _this = this;\n\n      validateFields(function (errors, values) {\n        if (!errors) {\n          console.log('values', values);\n        }\n\n        var param = _objectSpread({\n          entityId: _this3.pid\n        }, values.editForm);\n\n        console.log(param);\n        queryData(param, '/hrOrg/save').then(function (res) {\n          if (res.code == 0) {\n            _this.$message.success('编辑成功');\n\n            _this.editVisible = false;\n\n            _this.form.resetFields();\n\n            _this.getDateTree();\n\n            _this.getComInfo(_this.pid);\n          } else {\n            _this.$message.error(res.message);\n          }\n        });\n      });\n    },\n    // 删除\n    handleDelete: function handleDelete() {\n      var _this = this;\n\n      this.$confirm({\n        title: '警告',\n        content: \"\\u771F\\u7684\\u8981\\u5220\\u9664\\u8BE5\\u5355\\u4F4D\\u5417?\",\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk: function onOk() {\n          // 在这里调用删除接口\n          return new Promise(function (resolve, reject) {\n            setTimeout(Math.random() > 0.5 ? resolve : reject, 500);\n            var param = {\n              entityId: _this.pid\n            };\n            console.log(param);\n            queryData(param, '/hrOrg/delete').then(function (res) {\n              console.log(res);\n\n              if (res.code == 0) {\n                _this.$message.success('删除成功');\n\n                _this.getDateTree();\n              } else {\n                _this.$message.error(res.message);\n              }\n            });\n          }).catch(function () {\n            return console.log('Oops errors!');\n          });\n        },\n        onCancel: function onCancel() {\n          console.log('Cancel');\n        }\n      });\n    },\n    // 处理显隐\n    handleAddVisible: function handleAddVisible() {\n      if (this.pid != '') {\n        this.addVisible = true;\n      }\n    },\n    // 编辑\n    handleEditVisible: function handleEditVisible() {\n      this.form.resetFields();\n      this.editVisible = true;\n      this.editForm = this.comInfo;\n    },\n    //   获取树形结构数据\n    getDateTree: function getDateTree() {\n      var id = JSON.parse(localStorage.getItem('user')).id;\n\n      var _this = this;\n\n      queryData({\n        userid: id\n      }, 'hrOrg/list').then(function (res) {\n        console.log(res);\n\n        if (res.code == 0) {\n          _this.orgTree = res.result;\n\n          _this.getOrgList(res.result);\n\n          var expandedKeys = [];\n          res.result.map(function (value, index) {\n            if (value.children) {\n              var item = value.children;\n              item.map(function (value, index) {\n                expandedKeys.push(value.key);\n              });\n            } else {\n              expandedKeys.push(value.key);\n            }\n          });\n          _this.expandedKeys = expandedKeys;\n        }\n      });\n    },\n    //   获取用于搜索的list数组\n    getOrgList: function getOrgList(data) {\n      for (var i = 0; i < data.length; i++) {\n        var node = data[i];\n        var key = node.key;\n        var title = node.title;\n        var orgid = node.orgId;\n        var pid = node.pid;\n        this.orgList.push({\n          key: key,\n          title: title,\n          orgid: orgid,\n          pid: pid\n        });\n\n        if (node.children) {\n          this.getOrgList(node.children);\n        }\n      }\n    },\n    // 获取当前点击单位\n    onSelect: function onSelect(key) {\n      this.getComInfo(key[0]);\n    },\n    getComInfo: function getComInfo(pid) {\n      var param = {\n        orgId: pid\n      };\n\n      var _this = this;\n\n      queryData(param, '/hrOrg/getOrgMessage').then(function (res) {\n        console.log(res);\n\n        if (res.code == 0) {\n          _this.comInfo = Object(res.hrOrg);\n\n          if (Object.keys(_this.comInfo).length) {\n            _this.isSelect = true;\n            _this.pid = pid;\n          } else {\n            _this.isSelect = false;\n          }\n        }\n      });\n    },\n    onExpand: function onExpand(expandedKeys) {\n      //console.log(expandedKeys);\n      this.expandedKeys = expandedKeys;\n      this.autoExpandParent = false;\n    },\n    // 搜索\n    onChange: function onChange(e) {\n      var _this4 = this;\n\n      var value = e.target.value;\n      var expandedKeys = this.orgList.map(function (item) {\n        if (item.title.indexOf(value) > -1) {\n          return _this4.getParentKey(item.title, _this4.orgTree);\n        }\n\n        return null;\n      }).filter(function (item, i, self) {\n        return item && self.indexOf(item) === i;\n      });\n      Object.assign(this, {\n        expandedKeys: expandedKeys,\n        searchValue: value,\n        autoExpandParent: true\n      });\n    },\n    // 定位树形结构的数据\n    getParentKey: function getParentKey(title, tree) {\n      var parentKey = 0;\n\n      for (var i = 0; i < tree.length; i++) {\n        var node = tree[i];\n\n        if (node.children) {\n          if (node.children.some(function (item) {\n            return item.title === title;\n          })) {\n            parentKey = node.key;\n          } else if (this.getParentKey(title, node.children)) {\n            parentKey = this.getParentKey(title, node.children);\n          }\n        }\n      }\n\n      return parentKey;\n    }\n  }\n};",{"version":3,"sources":["ComList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <a-card :bordered=\"false\">\n      <a-row :gutter=\"8\">\n        <a-col :span=\"5\">\n          <a-input-search placeholder=\"关键字\" @change=\"onChange\" />\n          <a-tree\n            ref=\"tree\"\n            @expand=\"onExpand\"\n            :expandedKeys=\"expandedKeys\"\n            :autoExpandParent=\"autoExpandParent\"\n            @select=\"onSelect\"\n            :treeData=\"orgTree\"\n          >\n            <template slot=\"title\" slot-scope=\"{title}\">\n              <span v-if=\"title.indexOf(searchValue) > -1\">\n                {{title.substr(0, title.indexOf(searchValue))}}\n                <span\n                  style=\"color: #f50\"\n                >{{searchValue}}</span>\n                {{title.substr(title.indexOf(searchValue) + searchValue.length)}}\n              </span>\n              <span v-else>{{title}}</span>\n            </template>\n          </a-tree>\n        </a-col>\n        <a-col :span=\"17\">\n          <div class=\"table-operator\">\n            <a-button\n              type=\"primary\"\n              v-if=\"isSelect\"\n              icon=\"plus\"\n              style=\"margin-left:30px;\"\n              @click=\"handleAddVisible()\"\n              v-action:add\n            >新建下级</a-button>\n            <a-button\n              type=\"dashed\"\n              v-if=\"isSelect\"\n              icon=\"form\"\n              style=\"margin-left:30px;\"\n              @click=\"handleEditVisible()\"\n              v-action:edit\n            >编辑信息</a-button>\n            <a-button\n              type=\"danger\"\n              v-if=\"isSelect\"\n              icon=\"delete\"\n              style=\"margin-left:30px;\"\n              @click=\"handleDelete()\"\n              v-action:delete\n            >删除</a-button>\n            <a-card :bordered=\"false\" v-if=\"isSelect\">\n              <detail-list title=\"单位信息\" ref=\"list\">\n                <detail-list-item term=\"单位名称\">{{comInfo.name}}</detail-list-item>\n                <detail-list-item term=\"联系人\">{{comInfo.contact}}</detail-list-item>\n                <detail-list-item term=\"联系方式\">{{comInfo.contactWay}}</detail-list-item>\n                <detail-list-item term=\"备注\">{{comInfo.descn}}</detail-list-item>\n              </detail-list>\n              <a-divider style=\"margin-bottom: 32px\" />\n            </a-card>\n          </div>\n        </a-col>\n      </a-row>\n    </a-card>\n    <!-- 新增 -->\n    <a-modal title=\"新建下级\" v-model=\"addVisible\" @ok=\"handleAdd\">\n      <a-form :form=\"form\">\n        <a-form-item label=\"名称\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-input\n            v-decorator=\"[\n            'addForm.name',\n            {rules: [{ required: true, message: '请输入名称' }]}\n          ]\"\n            placeholder=\"名称\"\n          />\n        </a-form-item>\n        <a-form-item label=\"联系人\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-input v-decorator=\"[\n            'addForm.contact'\n          ]\" placeholder=\"联系人\" />\n        </a-form-item>\n        <a-form-item label=\"联系方式\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-input v-decorator=\"[\n            'addForm.contactWay'\n          ]\" placeholder=\"联系方式\" />\n        </a-form-item>\n        <a-form-item label=\"备注\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-textarea\n            v-decorator=\"[\n            'addForm.descn'\n          ]\"\n            placeholder=\"备注\"\n            :rows=\"4\"\n          />\n        </a-form-item>\n      </a-form>\n    </a-modal>\n\n    <!-- 编辑 -->\n    <a-modal title=\"编辑\" v-model=\"editVisible\" @ok=\"handleEdit\">\n      <a-form :form=\"form\">\n        <a-form-item label=\"名称\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-input\n            v-decorator=\"[\n            'editForm.name',\n            {rules: [{ required: true, message: '请输入名称' }],\n            initialValue: editForm.name}\n          ]\"\n            placeholder=\"名称\"\n          />\n        </a-form-item>\n        <a-form-item label=\"联系人\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-input\n            v-decorator=\"[\n            'editForm.contact',\n            {initialValue: editForm.contact}\n          ]\"\n            placeholder=\"联系人\"\n          />\n        </a-form-item>\n        <a-form-item label=\"联系方式\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-input\n            v-decorator=\"[\n            'editForm.contactWay',\n            {initialValue: editForm.contactWay}\n          ]\"\n            placeholder=\"联系方式\"\n          />\n        </a-form-item>\n        <a-form-item label=\"备注\" :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\">\n          <a-textarea\n            v-decorator=\"[\n            'editForm.descn',\n            {initialValue: editForm.descn}\n          ]\"\n            placeholder=\"备注\"\n            :rows=\"4\"\n          />\n        </a-form-item>\n      </a-form>\n    </a-modal>\n  </div>\n</template>\n\n<script>\nimport { queryData } from '@/api/common'\nimport DetailList from '@/components/tools/DetailList'\nconst DetailListItem = DetailList.Item\nexport default {\n  components: {\n    DetailList,\n    DetailListItem\n  },\n  data() {\n    return {\n      form: this.$form.createForm(this),\n      expandedKeys: [],\n      searchValue: '',\n      autoExpandParent: true,\n      orgTree: [],\n      orgList: [],\n      comInfo: [],\n      pid: '',\n      isSelect: false,\n      addVisible: false,\n      editVisible: false,\n      addForm: {\n        name: '',\n        contact: '',\n        contactWay: '',\n        descn: ''\n      },\n      editForm: {},\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 7 }\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 13 }\n      }\n    }\n  },\n  beforeMount() {\n    this.getDateTree()\n  },\n  methods: {\n    // 新增\n    handleAdd() {\n      const {\n        form: { validateFields }\n      } = this\n      var _this = this\n      validateFields((errors, values) => {\n        if (!errors) {\n          console.log('values', values)\n        }\n        var param = { pid: this.pid, ...values.addForm }\n        console.log(param)\n\n        queryData(param, '/hrOrg/save').then(res => {\n          if (res.code == 0) {\n            _this.$message.success('新建成功')\n            _this.addVisible = false\n            _this.form.resetFields()\n            _this.getDateTree()\n          } else {\n            _this.$message.error(res.message)\n          }\n        })\n      })\n    },\n    // 编辑\n    handleEdit() {\n      const {\n        form: { validateFields }\n      } = this\n      var _this = this\n      validateFields((errors, values) => {\n        if (!errors) {\n          console.log('values', values)\n        }\n        var param = { entityId: this.pid, ...values.editForm }\n        console.log(param)\n\n        queryData(param, '/hrOrg/save').then(res => {\n          if (res.code == 0) {\n            _this.$message.success('编辑成功')\n            _this.editVisible = false\n            _this.form.resetFields()\n            _this.getDateTree()\n            _this.getComInfo(_this.pid)\n          } else {\n            _this.$message.error(res.message)\n          }\n        })\n      })\n    },\n    // 删除\n    handleDelete() {\n      var _this = this\n      this.$confirm({\n        title: '警告',\n        content: `真的要删除该单位吗?`,\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk() {\n          // 在这里调用删除接口\n          return new Promise((resolve, reject) => {\n            setTimeout(Math.random() > 0.5 ? resolve : reject, 500)\n            var param = { entityId: _this.pid }\n            console.log(param)\n            queryData(param, '/hrOrg/delete').then(res => {\n              console.log(res)\n              if (res.code == 0) {\n                _this.$message.success('删除成功')\n                _this.getDateTree()\n              } else {\n                _this.$message.error(res.message)\n              }\n            })\n          }).catch(() => console.log('Oops errors!'))\n        },\n        onCancel() {\n          console.log('Cancel')\n        }\n      })\n    },\n    // 处理显隐\n    handleAddVisible() {\n      if (this.pid != '') {\n        this.addVisible = true\n      }\n    },\n    // 编辑\n    handleEditVisible() {\n      this.form.resetFields()\n      this.editVisible = true\n      this.editForm = this.comInfo\n    },\n    //   获取树形结构数据\n    getDateTree() {\n      var id = JSON.parse(localStorage.getItem('user')).id\n      var _this = this\n      queryData({ userid: id }, 'hrOrg/list').then(res => {\n        console.log(res)\n        if (res.code == 0) {\n          _this.orgTree = res.result\n          _this.getOrgList(res.result)\n          var expandedKeys = []\n          res.result.map((value, index) => {\n            if (value.children) {\n              var item = value.children\n              item.map((value, index) => {\n                expandedKeys.push(value.key)\n              })\n            } else {\n              expandedKeys.push(value.key)\n            }\n          })\n          _this.expandedKeys = expandedKeys\n        }\n      })\n    },\n    //   获取用于搜索的list数组\n    getOrgList(data) {\n      for (let i = 0; i < data.length; i++) {\n        const node = data[i]\n        const key = node.key\n        const title = node.title\n        const orgid = node.orgId\n        const pid = node.pid\n        this.orgList.push({ key, title: title, orgid: orgid, pid: pid })\n        if (node.children) {\n          this.getOrgList(node.children)\n        }\n      }\n    },\n    // 获取当前点击单位\n    onSelect(key) {\n      this.getComInfo(key[0])\n    },\n    getComInfo(pid) {\n      var param = { orgId: pid }\n      var _this = this\n      queryData(param, '/hrOrg/getOrgMessage').then(res => {\n        console.log(res)\n        if (res.code == 0) {\n          _this.comInfo = Object(res.hrOrg)\n          if (Object.keys(_this.comInfo).length) {\n            _this.isSelect = true\n            _this.pid = pid\n          } else {\n            _this.isSelect = false\n          }\n        }\n      })\n    },\n    onExpand(expandedKeys) {\n      //console.log(expandedKeys);\n      this.expandedKeys = expandedKeys\n      this.autoExpandParent = false\n    },\n    // 搜索\n    onChange(e) {\n      const value = e.target.value\n\n      const expandedKeys = this.orgList\n        .map(item => {\n          if (item.title.indexOf(value) > -1) {\n            return this.getParentKey(item.title, this.orgTree)\n          }\n          return null\n        })\n        .filter((item, i, self) => item && self.indexOf(item) === i)\n      Object.assign(this, {\n        expandedKeys,\n        searchValue: value,\n        autoExpandParent: true\n      })\n    },\n    // 定位树形结构的数据\n    getParentKey(title, tree) {\n      let parentKey = 0\n      for (let i = 0; i < tree.length; i++) {\n        const node = tree[i]\n        if (node.children) {\n          if (node.children.some(item => item.title === title)) {\n            parentKey = node.key\n          } else if (this.getParentKey(title, node.children)) {\n            parentKey = this.getParentKey(title, node.children)\n          }\n        }\n      }\n      return parentKey\n    }\n  }\n}\n</script>\n<style lang=\"less\">\n.ant-tree {\n  line-height: 2.3rem;\n}\n.ant-layout-content {\n  background: #fff;\n}\n.custom-tree {\n  /deep/ .ant-menu-item-group-title {\n    position: relative;\n    &:hover {\n      .btn {\n        display: block;\n      }\n    }\n  }\n\n  /deep/ .ant-menu-item {\n    &:hover {\n      .btn {\n        display: block;\n      }\n    }\n  }\n\n  /deep/ .btn {\n    display: none;\n    position: absolute;\n    top: 0;\n    right: 10px;\n    width: 20px;\n    height: 40px;\n    line-height: 40px;\n    z-index: 1050;\n\n    &:hover {\n      transform: scale(1.2);\n      transition: 0.5s all;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/company"}]}