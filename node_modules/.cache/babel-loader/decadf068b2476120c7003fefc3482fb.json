{"remainingRequest":"E:\\XiangMu\\ant-design-pro-vue\\node_modules\\babel-loader\\lib\\index.js!E:\\XiangMu\\ant-design-pro-vue\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\XiangMu\\ant-design-pro-vue\\src\\store\\modules\\permission.js","dependencies":[{"path":"E:\\XiangMu\\ant-design-pro-vue\\src\\store\\modules\\permission.js","mtime":1563758959894},{"path":"E:\\XiangMu\\ant-design-pro-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\XiangMu\\ant-design-pro-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\XiangMu\\ant-design-pro-vue\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport { asyncRouterMap, constantRouterMap } from '@/config/router.config';\n/**\r\n * 过滤账户是否拥有某一个权限，并将菜单从加载列表移除\r\n *\r\n * @param permission\r\n * @param route\r\n * @returns {boolean}\r\n */\n\nfunction hasPermission(permission, route) {\n  if (route.meta && route.meta.permission) {\n    var flag = false;\n\n    for (var i = 0, len = permission.length; i < len; i++) {\n      flag = route.meta.permission.includes(permission[i]);\n\n      if (flag) {\n        return true;\n      }\n    }\n\n    console.log(flag);\n    return false;\n  }\n\n  return true;\n}\n/**\r\n * 单账户多角色时，使用该方法可过滤角色不存在的菜单\r\n *\r\n * @param roles\r\n * @param route\r\n * @returns {*}\r\n */\n// eslint-disable-next-line\n\n\nfunction hasRole(roles, route) {\n  if (route.meta && route.meta.roles) {\n    return route.meta.roles.includes(roles.id);\n  } else {\n    return true;\n  }\n} // 递归过滤路由\n\n\nfunction filterAsyncRouter(routerMap, roles) {\n  var accessedRouters = routerMap.filter(function (route) {\n    if (hasPermission(roles.permissionList, route)) {\n      if (route.children && route.children.length) {\n        route.children = filterAsyncRouter(route.children, roles); // console.log(route.children);\n      }\n\n      return true;\n    }\n\n    return false;\n  });\n  return accessedRouters;\n}\n\nvar permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: []\n  },\n  mutations: {\n    SET_ROUTERS: function SET_ROUTERS(state, routers) {\n      state.addRouters = routers;\n      state.routers = constantRouterMap.concat(routers);\n    }\n  },\n  actions: {\n    GenerateRoutes: function GenerateRoutes(_ref, data) {\n      var commit = _ref.commit;\n      return new Promise(function (resolve) {\n        var roles = data.roles;\n        var accessedRouters = filterAsyncRouter(asyncRouterMap, roles);\n        commit('SET_ROUTERS', accessedRouters);\n        resolve();\n      });\n    }\n  }\n};\nexport default permission;",{"version":3,"sources":["E:\\XiangMu\\ant-design-pro-vue\\src\\store\\modules\\permission.js"],"names":["asyncRouterMap","constantRouterMap","hasPermission","permission","route","meta","flag","i","len","length","includes","console","log","hasRole","roles","id","filterAsyncRouter","routerMap","accessedRouters","filter","permissionList","children","state","routers","addRouters","mutations","SET_ROUTERS","concat","actions","GenerateRoutes","data","commit","Promise","resolve"],"mappings":";;AAAA,SAASA,cAAT,EAAyBC,iBAAzB,QAAkD,wBAAlD;AAEA;;;;;;;;AAOA,SAASC,aAAT,CAAwBC,UAAxB,EAAoCC,KAApC,EAA2C;AACzC,MAAIA,KAAK,CAACC,IAAN,IAAcD,KAAK,CAACC,IAAN,CAAWF,UAA7B,EAAyC;AACvC,QAAIG,IAAI,GAAG,KAAX;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGL,UAAU,CAACM,MAAjC,EAAyCF,CAAC,GAAGC,GAA7C,EAAkDD,CAAC,EAAnD,EAAuD;AACrDD,MAAAA,IAAI,GAAGF,KAAK,CAACC,IAAN,CAAWF,UAAX,CAAsBO,QAAtB,CAA+BP,UAAU,CAACI,CAAD,CAAzC,CAAP;;AACA,UAAID,IAAJ,EAAU;AACR,eAAO,IAAP;AACD;AACF;;AACDK,IAAAA,OAAO,CAACC,GAAR,CAAYN,IAAZ;AACA,WAAO,KAAP;AACD;;AACD,SAAO,IAAP;AACD;AAED;;;;;;;AAOA;;;AACA,SAASO,OAAT,CAAiBC,KAAjB,EAAwBV,KAAxB,EAA+B;AAC7B,MAAIA,KAAK,CAACC,IAAN,IAAcD,KAAK,CAACC,IAAN,CAAWS,KAA7B,EAAoC;AAClC,WAAOV,KAAK,CAACC,IAAN,CAAWS,KAAX,CAAiBJ,QAAjB,CAA0BI,KAAK,CAACC,EAAhC,CAAP;AACD,GAFD,MAEO;AACL,WAAO,IAAP;AACD;AACF,C,CACD;;;AACA,SAASC,iBAAT,CAA4BC,SAA5B,EAAuCH,KAAvC,EAA8C;AAC5C,MAAMI,eAAe,GAAGD,SAAS,CAACE,MAAV,CAAiB,UAAAf,KAAK,EAAI;AAChD,QAAIF,aAAa,CAACY,KAAK,CAACM,cAAP,EAAuBhB,KAAvB,CAAjB,EAAgD;AAC9C,UAAIA,KAAK,CAACiB,QAAN,IAAkBjB,KAAK,CAACiB,QAAN,CAAeZ,MAArC,EAA6C;AAC3CL,QAAAA,KAAK,CAACiB,QAAN,GAAiBL,iBAAiB,CAACZ,KAAK,CAACiB,QAAP,EAAiBP,KAAjB,CAAlC,CAD2C,CAE3C;AACD;;AACD,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GATuB,CAAxB;AAUA,SAAOI,eAAP;AACD;;AAED,IAAMf,UAAU,GAAG;AACjBmB,EAAAA,KAAK,EAAE;AACLC,IAAAA,OAAO,EAAEtB,iBADJ;AAELuB,IAAAA,UAAU,EAAE;AAFP,GADU;AAKjBC,EAAAA,SAAS,EAAE;AACTC,IAAAA,WAAW,EAAE,qBAACJ,KAAD,EAAQC,OAAR,EAAoB;AAC/BD,MAAAA,KAAK,CAACE,UAAN,GAAmBD,OAAnB;AACAD,MAAAA,KAAK,CAACC,OAAN,GAAgBtB,iBAAiB,CAAC0B,MAAlB,CAAyBJ,OAAzB,CAAhB;AACD;AAJQ,GALM;AAWjBK,EAAAA,OAAO,EAAE;AACPC,IAAAA,cADO,gCACqBC,IADrB,EAC2B;AAAA,UAAhBC,MAAgB,QAAhBA,MAAgB;AAChC,aAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAAA,YACpBnB,KADoB,GACVgB,IADU,CACpBhB,KADoB;AAE5B,YAAMI,eAAe,GAAGF,iBAAiB,CAAChB,cAAD,EAAiBc,KAAjB,CAAzC;AACAiB,QAAAA,MAAM,CAAC,aAAD,EAAgBb,eAAhB,CAAN;AACAe,QAAAA,OAAO;AACR,OALM,CAAP;AAMD;AARM;AAXQ,CAAnB;AAuBA,eAAe9B,UAAf","sourcesContent":["import { asyncRouterMap, constantRouterMap } from '@/config/router.config'\r\n\r\n/**\r\n * 过滤账户是否拥有某一个权限，并将菜单从加载列表移除\r\n *\r\n * @param permission\r\n * @param route\r\n * @returns {boolean}\r\n */\r\nfunction hasPermission (permission, route) {\r\n  if (route.meta && route.meta.permission) {\r\n    let flag = false\r\n    for (let i = 0, len = permission.length; i < len; i++) {\r\n      flag = route.meta.permission.includes(permission[i])\r\n      if (flag) {\r\n        return true\r\n      }\r\n    }\r\n    console.log(flag)\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\n/**\r\n * 单账户多角色时，使用该方法可过滤角色不存在的菜单\r\n *\r\n * @param roles\r\n * @param route\r\n * @returns {*}\r\n */\r\n// eslint-disable-next-line\r\nfunction hasRole(roles, route) {\r\n  if (route.meta && route.meta.roles) {\r\n    return route.meta.roles.includes(roles.id)\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n// 递归过滤路由\r\nfunction filterAsyncRouter (routerMap, roles) {\r\n  const accessedRouters = routerMap.filter(route => {\r\n    if (hasPermission(roles.permissionList, route)) {\r\n      if (route.children && route.children.length) {\r\n        route.children = filterAsyncRouter(route.children, roles)\r\n        // console.log(route.children);\r\n      }\r\n      return true\r\n    }\r\n    return false\r\n  })\r\n  return accessedRouters\r\n}\r\n\r\nconst permission = {\r\n  state: {\r\n    routers: constantRouterMap,\r\n    addRouters: []\r\n  },\r\n  mutations: {\r\n    SET_ROUTERS: (state, routers) => {\r\n      state.addRouters = routers\r\n      state.routers = constantRouterMap.concat(routers)\r\n    }\r\n  },\r\n  actions: {\r\n    GenerateRoutes ({ commit }, data) {\r\n      return new Promise(resolve => {\r\n        const { roles } = data\r\n        const accessedRouters = filterAsyncRouter(asyncRouterMap, roles)\r\n        commit('SET_ROUTERS', accessedRouters)\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default permission\r\n"]}]}